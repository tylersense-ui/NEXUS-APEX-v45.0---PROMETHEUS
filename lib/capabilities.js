/**
 * â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 * â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•
 * â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 * â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
 * â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 * â•šâ•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•
 *                           v45.0 - "Stealing Fire From The Gods"
 * 
 * @module      lib/capabilities
 * @description SystÃ¨me de dÃ©tection automatique des APIs et capacitÃ©s disponibles.
 *              Rend le code BitNode-agnostic en testant la disponibilitÃ© de chaque API.
 * @author      Claude (Anthropic) + tylersense-ui
 * @version     45.0 - PROMETHEUS
 * @date        2025-01-XX
 * @license     MIT
 * @requires    BitBurner v2.8.1+ (Steam)
 * 
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ”¥ PROMETHEUS ENHANCEMENTS
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * âœ“ Constructeur ultra-lÃ©ger (tests coÃ»teux diffÃ©rÃ©s)
 * âœ“ Cache intelligent pour Singularity (Ã©vite tests rÃ©pÃ©tÃ©s)
 * âœ“ Try/catch robuste autour de tous les tests d'API
 * âœ“ Documentation exhaustive de chaque capacitÃ© testÃ©e
 * âœ“ MÃ©thode update() optimisÃ©e (rÃ©utilise cache quand possible)
 * âœ“ Support BitNode-agnostic complet
 * âœ“ Logs icÃ´nÃ©s pour debugging (ğŸ”âœ…âŒ)
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * @usage
 *   import { Capabilities } from "/lib/capabilities.js";
 *   const caps = new Capabilities(ns);
 *   
 *   if (caps.formulas) {
 *       // Utiliser ns.formulas pour calculs prÃ©cis
 *   } else {
 *       // Fallback sur ns.hackAnalyze*, etc.
 *   }
 * 
 * @example
 *   // DÃ©tection des outils de crack
 *   const caps = new Capabilities(ns);
 *   const portsOuvrables = [caps.brutessh, caps.ftpcrack, caps.relaysmtp, 
 *                           caps.httpworm, caps.sqlinject].filter(Boolean).length;
 *   ns.tprint(`âœ… ${portsOuvrables} ports peuvent Ãªtre ouverts`);
 * 
 * @example
 *   // Utilisation conditionnelle de l'API Bourse
 *   if (caps.tix) {
 *       if (caps.has4S) {
 *           const forecast = ns.stock.getForecast("FSIG");
 *       } else {
 *           // Trading basique sans 4S Data
 *       }
 *   }
 * 
 * @example
 *   // Refresh pÃ©riodique (ex: toutes les 60s)
 *   setInterval(() => caps.update(), 60000);
 */

/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ“˜ CLASSE CAPABILITIES
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * DÃ©tecte automatiquement quelles APIs et programmes sont disponibles.
 * 
 * CapacitÃ©s testÃ©es :
 * - ğŸ”“ Outils de crack (BruteSSH.exe, FTPCrack.exe, etc.)
 * - ğŸ’¹ API Bourse (TIX + 4S Data)
 * - ğŸ“ Formulas.exe (calculs prÃ©cis)
 * - ğŸ­ Singularity API (automatisation avancÃ©e)
 * - ğŸ‘¥ Sleeve API (clones)
 * - ğŸ¢ Corporation API
 * - ğŸ‘Š Gang API
 * - âš”ï¸  Bladeburner API
 */
export class Capabilities {
    /**
     * Constructeur lÃ©ger - Initialise les capacitÃ©s de base uniquement
     * Les tests coÃ»teux sont diffÃ©rÃ©s Ã  update() pour Ã©viter les lags au boot
     * 
     * @param {NS} ns - Namespace BitBurner
     * 
     * @example
     *   const caps = new Capabilities(ns);
     *   // Constructeur instantanÃ©, update() est appelÃ© automatiquement
     */
    constructor(ns) {
        /** @type {NS} RÃ©fÃ©rence au namespace BitBurner */
        this.ns = ns;
        
        /**
         * Cache pour la dÃ©tection Singularity (null = non testÃ©, true/false = rÃ©sultat)
         * Ã‰vite de refaire le test coÃ»teux Ã  chaque update()
         * @private
         * @type {boolean|null}
         */
        this._singularityDetected = null;

        /**
         * Cache pour la dÃ©tection Sleeve (null = non testÃ©)
         * @private
         * @type {boolean|null}
         */
        this._sleeveDetected = null;

        /**
         * Cache pour la dÃ©tection Corporation (null = non testÃ©)
         * @private
         * @type {boolean|null}
         */
        this._corporationDetected = null;

        /**
         * Cache pour la dÃ©tection Gang (null = non testÃ©)
         * @private
         * @type {boolean|null}
         */
        this._gangDetected = null;

        /**
         * Cache pour la dÃ©tection Bladeburner (null = non testÃ©)
         * @private
         * @type {boolean|null}
         */
        this._bladeburnerDetected = null;
        
        // Initialisation immÃ©diate des capacitÃ©s (lÃ©ger)
        this.update();
    }

    /**
     * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     * ğŸ”„ MÃ‰THODE UPDATE (Refresh des capacitÃ©s)
     * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     * Met Ã  jour toutes les capacitÃ©s dÃ©tectables.
     * RÃ©utilise les caches quand possible pour Ã©viter les tests rÃ©pÃ©tÃ©s.
     * 
     * @public
     * @returns {void}
     * 
     * @example
     *   caps.update(); // Force la mise Ã  jour de toutes les capacitÃ©s
     */
    update() {
        const ns = this.ns;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ”“ LOGICIELS DE CRACK (toujours lÃ©gers Ã  tester)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /** 
         * BruteSSH.exe - Ouvre le port SSH (22)
         * @type {boolean}
         */
        this.brutessh = ns.fileExists("BruteSSH.exe", "home");
        
        /** 
         * FTPCrack.exe - Ouvre le port FTP (21)
         * @type {boolean}
         */
        this.ftpcrack = ns.fileExists("FTPCrack.exe", "home");
        
        /** 
         * relaySMTP.exe - Ouvre le port SMTP (25)
         * @type {boolean}
         */
        this.relaysmtp = ns.fileExists("relaySMTP.exe", "home");
        
        /** 
         * HTTPWorm.exe - Ouvre le port HTTP (80)
         * @type {boolean}
         */
        this.httpworm = ns.fileExists("HTTPWorm.exe", "home");
        
        /** 
         * SQLInject.exe - Ouvre le port SQL (1433)
         * @type {boolean}
         */
        this.sqlinject = ns.fileExists("SQLInject.exe", "home");

        /**
         * Compteur de ports ouvrable (0 Ã  5)
         * Utile pour savoir combien de serveurs sont accessibles
         * @type {number}
         */
        this.portOpeners = [
            this.brutessh, 
            this.ftpcrack, 
            this.relaysmtp, 
            this.httpworm, 
            this.sqlinject
        ].filter(Boolean).length;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ’¹ API BOURSE (TIX + 4S Data)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        this.tix = false;
        this.has4S = false;
        
        try {
            if (ns.stock) {
                /** 
                 * TIX API - AccÃ¨s au marchÃ© boursier (achat/vente d'actions)
                 * CoÃ»t: $5b + $25b pour compte
                 * @type {boolean}
                 */
                this.tix = ns.stock.hasTIXAPIAccess();
                
                /** 
                 * 4S Data - AccÃ¨s aux prÃ©visions de marchÃ© (getForecast, etc.)
                 * CoÃ»t: $1b additionnel
                 * @type {boolean}
                 */
                this.has4S = ns.stock.has4SDataAPIAccess();
            }
        } catch (e) {
            // L'API stock n'existe pas dans certains BitNodes
            this.tix = false;
            this.has4S = false;
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ“ FORMULAS.EXE (Calculs prÃ©cis)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /** 
         * Formulas.exe - Donne accÃ¨s Ã  ns.formulas pour calculs prÃ©cis
         * Permet de calculer exactement les threads, timing, chance sans approximations
         * CoÃ»t: $5b via Darkweb
         * @type {boolean}
         */
        this.formulas = ns.fileExists("Formulas.exe", "home");

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ­ SINGULARITY API (SF4)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /**
         * Singularity API - Automatisation complÃ¨te du joueur
         * Disponible: SF4 (BitNode 4) ou aprÃ¨s avoir terminÃ© BN4
         * Permet: factions, augmentations, travail, crimes, voyages, etc.
         * @type {boolean}
         */
        if (this._singularityDetected === null) {
            // Premier test (coÃ»teux, on le fait une seule fois)
            try {
                ns.singularity.getCurrentWork();
                this._singularityDetected = true;
            } catch (e) {
                this._singularityDetected = false;
            }
        }
        this.singularity = this._singularityDetected;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ‘¥ SLEEVE API (SF10)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /**
         * Sleeve API - Gestion des clones (duplicates)
         * Disponible: SF10 (BitNode 10) ou aprÃ¨s avoir terminÃ© BN10
         * Permet de contrÃ´ler jusqu'Ã  8 clones pour automatisation parallÃ¨le
         * @type {boolean}
         */
        if (this._sleeveDetected === null) {
            try {
                ns.sleeve.getNumSleeves();
                this._sleeveDetected = true;
            } catch (e) {
                this._sleeveDetected = false;
            }
        }
        this.sleeve = this._sleeveDetected;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ¢ CORPORATION API (SF3)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /**
         * Corporation API - CrÃ©ation et gestion d'entreprise
         * Disponible: SF3 (BitNode 3) ou aprÃ¨s avoir terminÃ© BN3
         * @type {boolean}
         */
        if (this._corporationDetected === null) {
            try {
                ns.corporation.hasCorporation();
                this._corporationDetected = true;
            } catch (e) {
                this._corporationDetected = false;
            }
        }
        this.corporation = this._corporationDetected;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ‘Š GANG API (SF2)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /**
         * Gang API - CrÃ©ation et gestion de gang criminel
         * Disponible: SF2 (BitNode 2) ou aprÃ¨s avoir terminÃ© BN2
         * NÃ©cessite: -54,000 karma et rejoindre faction gang
         * @type {boolean}
         */
        if (this._gangDetected === null) {
            try {
                ns.gang.inGang();
                this._gangDetected = true;
            } catch (e) {
                this._gangDetected = false;
            }
        }
        this.gang = this._gangDetected;

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // âš”ï¸ BLADEBURNER API (SF6/SF7)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /**
         * Bladeburner API - Division secrÃ¨te anti-synthoid
         * Disponible: SF6 (BitNode 6), SF7 (BitNode 7) ou aprÃ¨s BN6/BN7
         * @type {boolean}
         */
        if (this._bladeburnerDetected === null) {
            try {
                ns.bladeburner.joinBladeburnerDivision();
                this._bladeburnerDetected = true;
            } catch (e) {
                this._bladeburnerDetected = false;
            }
        }
        this.bladeburner = this._bladeburnerDetected;
    }

    /**
     * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     * ğŸ” MÃ‰THODES UTILITAIRES
     * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     */

    /**
     * Force la rÃ©initialisation de tous les caches
     * Utile si on change de BitNode ou aprÃ¨s avoir achetÃ© un programme
     * 
     * @public
     * @returns {void}
     * 
     * @example
     *   // AprÃ¨s avoir achetÃ© Formulas.exe
     *   ns.singularity.purchaseProgram("Formulas.exe");
     *   caps.resetCache();
     *   caps.update();
     *   if (caps.formulas) { ... }
     */
    resetCache() {
        this._singularityDetected = null;
        this._sleeveDetected = null;
        this._corporationDetected = null;
        this._gangDetected = null;
        this._bladeburnerDetected = null;
        this.update();
    }

    /**
     * Retourne un rÃ©sumÃ© des capacitÃ©s disponibles (pour debugging)
     * 
     * @public
     * @returns {Object} Objet contenant toutes les capacitÃ©s
     * 
     * @example
     *   const summary = caps.getSummary();
     *   ns.tprint(JSON.stringify(summary, null, 2));
     */
    getSummary() {
        return {
            // Outils de crack
            crack: {
                brutessh: this.brutessh,
                ftpcrack: this.ftpcrack,
                relaysmtp: this.relaysmtp,
                httpworm: this.httpworm,
                sqlinject: this.sqlinject,
                total: this.portOpeners
            },
            // APIs spÃ©cialisÃ©es
            apis: {
                formulas: this.formulas,
                tix: this.tix,
                has4S: this.has4S,
                singularity: this.singularity,
                sleeve: this.sleeve,
                corporation: this.corporation,
                gang: this.gang,
                bladeburner: this.bladeburner
            }
        };
    }

    /**
     * Affiche un rapport dÃ©taillÃ© des capacitÃ©s dans les logs
     * 
     * @public
     * @param {boolean} [useTPrint=false] - Si true, utilise tprint au lieu de print
     * @returns {void}
     * 
     * @example
     *   caps.printReport();           // Dans tail uniquement
     *   caps.printReport(true);       // Dans terminal
     */
    printReport(useTPrint = false) {
        const print = useTPrint ? this.ns.tprint.bind(this.ns) : this.ns.print.bind(this.ns);
        
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        print("ğŸ” RAPPORT DE CAPACITÃ‰S - NEXUS-APEX PROMETHEUS");
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        print("");
        print("ğŸ”“ OUTILS DE CRACK:");
        print(`   ${this.brutessh ? 'âœ…' : 'âŒ'} BruteSSH.exe`);
        print(`   ${this.ftpcrack ? 'âœ…' : 'âŒ'} FTPCrack.exe`);
        print(`   ${this.relaysmtp ? 'âœ…' : 'âŒ'} relaySMTP.exe`);
        print(`   ${this.httpworm ? 'âœ…' : 'âŒ'} HTTPWorm.exe`);
        print(`   ${this.sqlinject ? 'âœ…' : 'âŒ'} SQLInject.exe`);
        print(`   â†’ Total: ${this.portOpeners}/5 ports ouvrable`);
        print("");
        print("ğŸ“ CALCULS:");
        print(`   ${this.formulas ? 'âœ…' : 'âŒ'} Formulas.exe`);
        print("");
        print("ğŸ’¹ BOURSE:");
        print(`   ${this.tix ? 'âœ…' : 'âŒ'} TIX API`);
        print(`   ${this.has4S ? 'âœ…' : 'âŒ'} 4S Data (Forecasts)`);
        print("");
        print("ğŸ­ APIS AVANCÃ‰ES:");
        print(`   ${this.singularity ? 'âœ…' : 'âŒ'} Singularity (SF4)`);
        print(`   ${this.sleeve ? 'âœ…' : 'âŒ'} Sleeve (SF10)`);
        print(`   ${this.corporation ? 'âœ…' : 'âŒ'} Corporation (SF3)`);
        print(`   ${this.gang ? 'âœ…' : 'âŒ'} Gang (SF2)`);
        print(`   ${this.bladeburner ? 'âœ…' : 'âŒ'} Bladeburner (SF6/SF7)`);
        print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
    }
}

/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ”¥ PROMETHEUS SIGNATURE
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */
/** @param {NS} ns */
export async function main(ns) {
    ns.tprint("\x1b[38;5;196m");
    ns.tprint("    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—");
    ns.tprint("    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•");
    ns.tprint("    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—");
    ns.tprint("    â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘");
    ns.tprint("    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘");
    ns.tprint("    â•šâ•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•");
    ns.tprint("                              v45.0 - \"Stealing Fire From The Gods\"");
    ns.tprint("\x1b[0m");
    ns.tprint("");
    
    // DÃ©monstration complÃ¨te des capacitÃ©s
    const caps = new Capabilities(ns);
    
    ns.tprint("âœ… DÃ©tection automatique des capacitÃ©s BitNode-agnostic...");
    ns.tprint("");
    
    caps.printReport(true);
    
    ns.tprint("");
    ns.tprint("ğŸ“Š JSON Summary:");
    ns.tprint(JSON.stringify(caps.getSummary(), null, 2));
}
